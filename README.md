### 基于mnist的数字识别
## 这个项目的目标是使用对比学习对MNIST数据集进行预训练和分类。项目主要包括以下几个部分：

准备数据：从MNIST数据集加载训练和测试数据，然后使用自定义的DataGenerator生成器为对比学习任务生成minibatch样本和标签。

构建模型：使用Keras构建一个卷积神经网络模型，该模型具有用于对比学习的编码器和投影头。

自定义对比损失函数：实现自定义的对比损失函数，用于计算模型在对比学习任务中的损失。

预训练模型：使用对比学习任务训练模型，以便模型学习有用的特征表示。

TSNE可视化：在预训练结束后，使用t-SNE算法对模型提取的特征进行可视化，以了解学习到的特征的分布情况。

构建分类器：在预训练模型的基础上，添加一个多层感知器（MLP）层，用于最终的数字分类任务。

训练分类器：使用标签训练分类器，并在测试集上评估其性能。报告分类任务的准确率。

预测单个图像：添加一个功能，用于预测单个输入图像的数字标签。该功能接受图像路径或MNIST数据集中图像的索引作为输入，并返回预测的数字标签。

保存和加载模型：在训练完成后，将分类器模型保存到文件中，以便在其他项目中重用或在训练中断后恢复训练。

项目中的关键文件包括：

main.py：包含项目的主要代码，用于执行上述所有步骤。
data_generator.py：包含自定义的DataGenerator类，用于生成对比学习任务的minibatch样本和标签。
model.py：包含构建模型和分类器的函数。
loss.py：包含自定义对比损失函数的实现。
visualization.py:：包含使用t-SNE算法进行特征可视化的函数。这个文件中的函数将模型提取的特征降维为二维数据，然后使用matplotlib库绘制散点图，以直观地了解学习到的特征的分布情况。
test.py:载入保存的模型，导入随机数据运行模型，进行识别测试
通过这个项目，我们展示了如何使用对比学习预训练一个模型，然后在该模型的基础上训练一个分类器，以在MNIST数据集上进行数字分类。
下面是运行结果图：

![202347185153](https://user-images.githubusercontent.com/81458072/230603694-8fac03b6-67d4-4f45-ba9d-9535816aef55.jpg)
![20234718523](https://user-images.githubusercontent.com/81458072/230603729-637f54cb-f3b3-4615-b9fa-ce6fc9d5ff47.jpg)
！[202347185239](https://user-images.githubusercontent.com/81458072/230603762-b706272e-8d02-4137-b464-d2e3970a5992.jpg)
![202347185329](https://user-images.githubusercontent.com/81458072/230603766-c6a7499e-6c63-4200-891c-a3d7cc75b17b.jpg)

